
## Nova Pro
### 세션 개요
* 세션은 SaaS 407의 일부로, 다양한 멀티테넌트 생성형 AI 아키텍처를 구축하는 방법을 안내합니다.
* 주로 SaaS 아키텍처 문제를 해결하여 강력한 생성형 AI 멀티테넌트 아키텍처를 만드는 방법을 다룹니다.
* 세션 끝에 GitHub 리포지토리 링크와 새로운 워크샵 링크를 제공합니다.

### 발표자 소개
* Ujwal Bukka: AWS 팩토리 팀의 수석 솔루션 아키텍트, ISV 및 기업의 SaaS 여정을 지원
* Mehran Najafi: 토론토 소재 책임 솔루션 아키텍트, re:Invent 첫날 발표

### 주요 내용
* LLM 기반 솔루션 구축의 복잡성과 비용 문제
* 멀티테넌트 환경에서의 추가적인 문제와 도전
* 두 가지 인기 있는 생성형 AI 아키텍처: RAG (Retrieval Augmented Generation)와 파인튜닝

### RAG 아키텍처
* 기본 LLM을 사용하여 고객 데이터를 임베딩하고 벡터 데이터베이스에 저장
* 사용자 요청이 들어오면 유사성 검색을 통해 관련 지식을 검색하여 LLM에 제공
* Amazon Bedrock을 통해 다양한 LLM 옵션에 접근 가능

### 파인튜닝 아키텍처
* 사용자 데이터를 사용하여 모델을 파인튜닝하여 특정 지식을 모델에 내장
* 요청이 들어올 때 이미 배경 지식을 가진 모델이 응답 생성
* 파인튜닝은 프롬프트의 길이를 줄일 수 있지만 호스팅 및 하드웨어 비용이 추가됨

### AWS 관리 서비스의 역할
* Amazon Bedrock Knowledge Base: 관리형 RAG 기능으로 데이터 임베딩, 저장, 검색 및 Bedrock으로 전송
* Amazon Bedrock의 맞춤형 모델 기능: 사용자 데이터를 기반으로 모델 파인튜닝

### 멀티테넌트 아키텍처
* 각 테넌트의 데이터를 분리하고 관리
* 기본 티어와 프리미엄 티어의 차이: 공유 서비스 vs 전용 서비스
* 테넌트 온보딩, 프로비저닝, 관리 및 모니터링

### 테넌트 격리
* 기본 티어: 공유 서비스 내에서 테넌트 데이터 분리 (S3 프리픽스, OpenSearch Serverless 인덱스)
* 프리미엄 티어: 전용 리소스 (버킷, 클러스터, 컬렉션)를 사용하여 격리

### 비용 계산
* 테넌트별 비용 계산 방법: 메트릭 캡처, 집계 및 비용 산출
* LLM 상호작용에서 입력 및 출력 토큰 수 캡처
* 스토리지 비용 계산: OpenSearch Serverless 컬렉션의 데이터 저장량, 인덱싱 비용, 검색 및 쿼리 비용

### 노이지 네이버 문제 해결
* API 레벨에서 테넌트 토큰 사용량을 기반으로 스로틀링 경험 구현
* 람다 함수를 사용하여 실시간으로 토큰 사용량 집계 및 제한 확인

### 주요 테이크어웨이
* 서비스 쿼터 및 제한 사항 고려
* 테넌트 기반 경험 제공을 위한 티어링 전략 활용
* IAM을 활용한 테넌트 격리 구현
* 테넌트 컨텍스트와 함께 메트릭 캡처 및 활용

### 추가 리소스
* GitHub 리포지토리 링크
* 새로운 워크샵 링크 (SaaS 405)
* 추가 세션 및 워크샵 정보


## Cloaude 3.5 Sonnet v2
### 생성형 AI와 멀티테넌시 아키텍처의 복잡성
* 단일 고객을 위한 LLM 솔루션도 하드웨어 가속기 호스팅, 토큰당 비용, 미세조정 등으로 인해 복잡하다.
* 수천 명의 테넌트로 확장 시 여러 LLM 관리, 고객 데이터 보안, 비용 관리 등 더 많은 과제가 발생한다.
* AWS의 관리형 솔루션을 통해 복잡한 부분을 추상화하고 솔루션에 집중할 수 있다.

### RAG와 Fine-tuning 아키텍처 
* RAG는 일반 LLM을 활용하고 벡터 데이터베이스를 통해 지식을 검색하는 방식이다.
* Fine-tuning은 모델을 사용자 데이터로 학습시켜 맞춤화하는 방식이다.
* Amazon Bedrock Knowledge Base는 관리형 RAG 서비스를 제공한다.
* 두 방식을 결합하여 정적 데이터는 fine-tuning, 동적 데이터는 RAG로 처리할 수 있다.

### 멀티테넌트 격리와 보안
* 기본 티어는 공유 리소스를 사용하며 테넌트별 접두사와 인덱스로 격리한다.
* 프리미엄 티어는 전용 리소스를 제공하여 완전한 격리를 보장한다.
* IAM 역할과 정책을 통해 테넌트별 접근 제어를 구현한다.
* 테넌트 컨텍스트를 포함한 메트릭 수집이 중요하다.

### 비용 관리와 모니터링
* 테넌트별 토큰 사용량과 리소스 사용량을 추적한다.
* CloudWatch와 Athena를 활용해 비용을 집계하고 분석한다.
* API 게이트웨이 수준에서 테넌트별 사용량 제한을 구현할 수 있다.
* 기본/프리미엄 티어에 따라 차별화된 비용 정책을 적용한다.

