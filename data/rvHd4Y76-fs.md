
## Nova Pro
### 재시도의 문제점
* 재시도는 일시적인 실패에 대해서는 효과적이지만, 시스템적인 실패 상황에서는 오히려 시스템을 더 악화시킬 수 있다.
* 기존의 재시도 방식은 과부하 상황에서 시스템을 회복할 수 없게 만들 수 있다.
* AWS에서 사용하는 토큰 버킷 알고리즘과 같은 적응형 재시도 방식은 시스템의 회복을 가능하게 한다.

### 회로 차단기 (Circuit Breaker)
* 회로 차단기는 과부하나 건강하지 않은 다운스트림 시스템에 대한 첫 번째 시도를 결정하는 데 사용된다.
* 회로 차단기는 비필수 기능을 제거하여 가용성을 보존하거나, 업스트림 가용성을 희생하여 다운스트림 시스템의 회복을 돕는 데 사용될 수 있다.
* 단순한 온/오프 회로 차단기는 동적 동작이 좋지 않고, 샤드 시스템의 가용성을 감소시킬 수 있다.
* 성공적인 회로 차단기는 다운스트림 서비스의 내부 세부 사항을 알고 있어야 할 수 있다.

### 꼬리 지연 시간 (Tail Latency)
* 꼬리 지연 시간은 서비스의 지연 시간 분포에서 가장 느린 요청을 나타낸다.
* 병렬로 요청을 보내는 기술(예: 헤징, 지워진 코딩)은 꼬리 지연 시간을 줄이는 데 효과적일 수 있다.
* 지워진 코딩은 스토리지 시스템과 캐시에서 특히 효과적이며, 시스템의 탄력성을 향상시킬 수 있다.

### 메타안정성 (Metastability)
* 메타안정성은 시스템이 과부하 상태에서 회복하기 위해 부하를 크게 줄여야 하는 현상을 나타낸다.
* 대부분의 시스템은 최적 부하 이하로 부하를 줄여야 정상 작동 상태로 회복된다.
* 적응형 재시도 알고리즘은 메타안정성 문제를 피할 수 있다.

### 시뮬레이션
* 시뮬레이션은 시스템 동작을 이해하고 예측하는 데 매우 강력한 도구이다.
* 간단한 이벤트 기반 시뮬레이션을 작성하여 시스템 동작을 탐색할 수 있다.
* 생성형 AI를 사용하여 시뮬레이션 코드를 작성하는 것도 효과적일 수 있다.

### 주요 테이크어웨이
* 지터는 항상 좋다. 재시도는 메타안정성 실패를 도입할 수 있다.
* 토큰 버킷 알고리즘을 사용하면 이러한 실패 모드를 피할 수 있다.
* 회로 차단기는 강력한 도구이지만 샤드 시스템과 마이크로서비스 아키텍처에서 주의해서 사용해야 한다.
* 꼬리 지연 시간을 줄이기 위한 기술(예: 헤징, 지워진 코딩)은 시스템의 성능을 향상시킬 수 있다.
* 시뮬레이션은 시스템 동작을 이해하고 예측하는 데 매우 유용한 도구이다.


## Cloaude 3.5 Sonnet v2
### 재시도(Retry) 메커니즘의 문제점과 해결방안
* 단순 재시도는 시스템 과부하 시 문제를 더 악화시킬 수 있다. 3번의 재시도는 시스템 부하를 4배까지 증가시킬 수 있다.
* AWS는 토큰 버킷 알고리즘을 통해 적응형 재시도 메커니즘을 구현했다. 이를 통해 시스템 부하를 101% 수준으로 제한할 수 있다.
* 지터(Jitter)를 추가하는 것이 좋다. 무작위성을 통해 부하 스파이크를 분산시킬 수 있다.

### 서킷 브레이커의 장단점
* 서킷 브레이커는 시스템 과부하 시 선택적 기능을 줄이거나 부하를 거부하는 데 효과적이다.
* 샤딩된 시스템에서는 가용성을 저하시킬 수 있다. 일부 샤드의 실패가 전체 시스템 중단으로 이어질 수 있다.
* 마이크로서비스 아키텍처에서는 장애 영향 범위가 확대될 수 있다.

### 지연시간 테일 관리 기법
* 요청을 2번 보내고 먼저 오는 응답을 사용하는 헤징 기법은 지연시간 테일을 60% 개선할 수 있다.
* 이레이저 코딩은 N개 요청 중 K개 응답으로 결과를 조합하는 기법으로, 스토리지 시스템에서 효과적이다.
* AWS Lambda는 4-of-5 코드를 사용해 컨테이너 로딩 시스템의 지연시간 테일을 개선했다.

### 시스템 안정성과 시뮬레이션
* 대부분의 분산 시스템은 과부하 시점을 넘어서면 부하가 증가할수록 성공률이 감소하는 메타안정성 문제를 겪는다.
* 시뮬레이션은 시스템 동작을 이해하고 설계 선택을 검증하는 강력한 도구다.
* 생성형 AI를 활용하면 시뮬레이션 코드 작성을 더 빠르게 할 수 있다.

