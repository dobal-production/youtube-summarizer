- 좋아요, 여러분 안녕하세요.엄지손가락 하나 줄래요?
헤드폰으로 제 목소리가 들리나요?좋아요, 엄지손가락을 치켜세웁니다.멋지네요.re:Invent의 첫날 행복한 하루 되세요. 이곳에 오신 것을 환영합니다.
쿠버네티스 205 세션. 여기서 새로운 내용을 소개할 예정입니다.
EKS용 기능.(웃음) 네, 넣어야 돼요
헤드폰을 끼고 제 말을 들어보세요.그래서 우리는 EKS 하이브리드 노드라는 새로운 EKS 기능을 소개할 것입니다. 이 기능을 통해 다음을 가능하게 할 것입니다.
온프레미스 및 엣지 인프라를 다음과 같이 사용할 수 있습니다.
EKS 클러스터의 용량은 기본적으로
EKS의 강력한 기능을 온프레미스 배포에 적용할 수 있습니다.제 이름은 크리스 스플린터이고 제품 관리자로 일하고 있습니다.
AWS의 쿠버네티스 팀.저는 EKS를 AWS 환경을 넘어 온프레미스 데이터까지 확장하는 EKS 제품을 구축하는 데 중점을 둡니다.
센터 및 엣지 시설.조나단 오그던도 있습니다.
오늘 노스웨스턴 뮤추얼에서 온 사람이 잠시 후에 와서 그의 팀에 대해 이야기할 거예요.
출시 전 몇 달간 하이브리드 노드를 사용해 본 경험여기에서 아젠다를 간단히 살펴보겠습니다.먼저 Kubernetes를 온프레미스로 실행하는 고객으로부터 들은 문제점과 이러한 고객의 의견을 살펴보겠습니다.
대화는 우리의 제품 전략에 큰 영향을 미쳤고,
EKS 팀의 로드맵.그럼 다음 내용을 살펴보겠습니다.
온프레미스 및 엣지 사용 사례를 위한 EKS 제품 포트폴리오는 물론 전혀 다릅니다.
하이브리드 노드를 구축하게 된 계기.그리고 이 중 대부분은
이 자리에서 하이브리드 노드에 대해 자세히 알아보도록 하겠습니다.
아키텍처, 작동 방식, 이를 자체 사용 사례에 적용하는 방법
자체 환경에서그런 다음 존에게 전달해 줄게. 존은 그의 팀을 담당할 것이다.
하이브리드 노드에 대한 경험과 다음과 같은 몇 가지
출시 전 몇 달 동안 테스트를 거쳤습니다.그리고 이 아젠다에 대한 Q&A도 있습니다.조용한 세션이기 때문에
실시간 Q&A는 진행하지 않지만 질문이나 의견이 있는 경우 나중에 답변해 드리겠습니다.그럼 본격적으로 시작하기 전에
잠깐 들어가서 말해볼게
제가 제품이라는 점에서 가장 마음에 들어요.
EKS 팀의 매니저는 제가 모든 사람들과 이야기를 나눌 수 있다는 것입니다.
당신은 자신이 만들고 있는 것들, 어려운 것, 어떤 것들에 대해 거의 매일 같이 이야기하죠.
제대로 작동하고 있는 것, 작동하지 않는 것, EKS에 수정 사항이나 기능을 내장하면 무엇이 조금 더 쉬워질 수 있을까요?그리고 이 모든 것들이
대화는 새로운 아이디어로 성장할 수 있는 씨앗을 심습니다.
새로운 제품, 새로운 기능 및 새로운 수정 사항
우리가 만드는 제품.그리고 한 가지
AWS 쿠버네티스 팀, 특히 제게 아주 분명해졌습니다.
AWS에서 EKS를 실행하고 계신 분들이 정말 많으신가요?
클라우드에는 온프레미스에서 실행되는 애플리케이션도 있습니다.그리고 그 사실도 많이 알게 되었습니다.
여러 환경에서 애플리케이션을 실행해야 하기 때문에 애초에 쿠버네티스를 여러 번 사용하시는 분들이 많을 것입니다.쿠버네티스의 핵심 API는
그리고 선언적 작업은 일관되게 유지됩니다.
어디에서든 실행할 수 있습니다.그러니까, 말씀드린 김에 우리는
Kubernetes를 온프레미스로 실행하는 것과 이를 어렵게 만드는 요소에 대해 귀사와 고객으로부터 당면 과제에 대해 분명히 들었습니다.그리고 이러한 문제 중 상당수는
애플리케이션 포트폴리오가 확장되고 점점 더 많아짐에 따라 점점 더 고통스러워집니다.
유지 관리, 이것이 바로 그 결과입니다.
우리 모두가 하고자 하는 것은 더 많은 가치를 제공하는 것입니다.
최종 고객에게 더 빠르게 배송할 수 있습니다.우리의 대화에서도 마찬가지입니다.
예를 들어, 여러분 모두와 함께, 달리면서 들은 적이 있습니다.
Kubernetes 온프레미스에서는 이러한 Kubernetes 클러스터를 관리하고 패치를 관리하여 컨트롤 플레인을 최신 상태로 유지하는 데 많은 운영 오버헤드가 발생합니다.쿠버네티스를 실행해 본 적이 있다면
온프레미스는 이전에 다루어 본 적이 있을 것입니다.
클러스터 인증서 만료 또는 DHCP 임대 만료 시 바로 전송 가능
클러스터가 광란에 빠졌습니다.그 모든 것들이 다 그렇지는 않습니다.
우리가 고객에게 제공할 수 있는 가치에 직접적인 영향을 미치며, 이는 정말 동일합니다.
우리 팀의 운영 오버헤드와 비효율성일 뿐이죠.우리가 당면한 또 다른 과제는
흔히 듣게 되는 얘기는, 경험이 많지 않다는 얘기
쿠버네티스 관리.우리 모두 제품을 만드는 데 사용하는 시스템에 대해 마법처럼 더 많은 전문 지식과 지식을 갖고 싶어할 것이라고 확신합니다. 하지만 현실은
기술은 정말 빠르게 발전합니다.무언가를 채택하자마자 새로운 것이 생겨나는 것처럼
거기 쓰고 싶은 거 있잖아그리고 안타깝게도 많이
오랫동안 사용되어 온 온프레미스 시스템 중 일부는 클라우드에 새로 구축한 시스템보다 뒤처지는 경향이 있습니다.그리고 Kubernetes를 온프레미스로 실행해 본 적이 있다면, 실제로는 그렇지 않습니다.
마음이 약한 분들을 위해 말이죠.그리고 마지막 도전은
여기서 말씀드리고 싶은 것은 기술의 무분별한 확산입니다.실행 중인 애플리케이션이 있다면
다양한 환경에서 도구를 사용하고 있다는 것을 알고 계실 것입니다.
환경에서 작업을 실행하는 데 사용하는 시스템
클라우드는 온프레미스에서 실행하는 데 사용하는 도구 및 시스템과 다릅니다.따라서 이는 다음과 같습니다.
프로세스도 다르고, 기술도 다르고
위치에 따라 지식 기반이 다릅니다.
애플리케이션이 실행되고 있는데 이 모든 것이 합쳐져 사일로가 됩니다.그리고 사일로는 효율적이지 않습니다.
게다가 확장도 안 되죠.이런 것들은 제가 제품을 정의하고 바꾸면서 항상 고민하는 몇 가지 사항에 불과합니다.
EKS 측면에서의 전략.이렇게 생각할 수도 있겠죠. “AWS에서 온 이 사람이 제 배포에 대해 얘기하면서 뭘 하는 거지?
그건 AWS에서 실행되지 않는 건가요?”간단히 말해서, 우리는
고객들의 이야기를 들어보세요. 제가 말씀드린 것처럼
많은 고객들이 이런 사실을 확실히 알게 되었습니다.
클라우드에서 EKS를 사용하고 있고 애플리케이션도 있습니다.
자체 온프레미스 환경에서 실행되고 있다는 것.그리고 전반적으로
쿠버네티스 팀의 목표는 쿠버네티스 관리 및 쿠버네티스 운영을 성공으로 만드는 것입니다.
고객이 어디에 있든 관계없이 사후 고려 사항
애플리케이션을 실행해야 하며, 애플리케이션을 실행해야 하는 모든 곳에서 애플리케이션을 실행하는 것이 중요합니다.우리는 고객들이 가지고 있다는 것을 알고 있습니다.
모든 곳의 애플리케이션, AWS 온프레미스, 다른 곳의 애플리케이션
클라우드가 있고 클라우드가 거기에서 실행되는데, 이는 딜리버리가 필요하기 때문입니다.
최종 고객에 대한 응답 지연 시간이 짧습니다.또는 온프레미스에 엄격하거나 까다로운 데이터 종속성으로 인해 다음과 같은 문제가 발생할 수 있습니다.
사물을 다른 곳으로 옮기는 것.때로는 운영해야 한다는 규제 규정을 준수해야 하는 경우도 있을 수 있습니다.
사용자가 완전히 제어할 수 있는 위치에 있는 애플리케이션.그리고 요구 사항을 충족하기 위해
이러한 유형의 애플리케이션을 사용하는 이러한 고객의 요구 사항에 따라 EKS 솔루션은
애플리케이션이 실행되는 모든 위치에서 실행됩니다.자, 그럼 이제
온프레미스 및 엣지 사용 사례를 위한 EKS 포트폴리오.이 분야에서의 우리의 여정
2019년에 아웃포스트의 EKS로 시작했습니다.혹시 모르신다면 아웃포스트
데이터에서 실행할 수 있는 AWS 관리형 인프라입니까?
센터 또는 콜로 시설.정말 대단한 곳 중 하나
Outpost의 장점은 애플리케이션을 실행하는 방식에 따른 일관성입니다.
AWS 리전에서.예를 들어 컴퓨팅에는 EC2를, 네트워킹에는 VPC를 사용할 수 있습니다.
스토리지용으로는 EBS와 S3를, 그리고 네, 여러분의 스토리지를 위한 EKS도 있습니다.
컨테이너식 워크로드.우리가 알게 된 사실은 고객들이
Outpost의 EKS를 통해 얻을 수 있는 경험이 정말 마음에 듭니다. 다음과 일치하기 때문입니다.
클라우드에서 EKS를 사용하는 방법그래서 우리는 고객을 보았습니다.
다양한 사용 사례에 대해 Outpost에 EKS를 도입하세요.그 중 몇 가지는
이 슬라이드에 강조되어 있습니다.일반 사용 사례와 같은 사용 사례
엔터프라이즈 현대화 또는 로컬 데이터 처리
따라서 뱅킹 애플리케이션 또는 리얼 머니 게임
몇 가지 예를 들자면 응용 프로그램을 들 수 있습니다.하지만 아웃포스트의 EKS를 통해 알게 된 사실은
고객 세그먼트이자 고객 유형입니다.
실제로는 없었던 특정 유형의 워크로드
아웃포스트에서 EKS로 주소 지정하기그리고 이러한 유형의 고객은 연결이 끊기거나 간헐적인 연결 환경에서 애플리케이션을 실행해야 했는데, 이 환경에서는 매우 엄격한 조건이 충족되었습니다.
네트워킹 요구 사항 (예:
데이터 센터 외부 또는 엣지 로케이션 외부의 외부 엔티티에 연결합니다.이를 계기로 EKS Anywhere를 구축하게 되었고, 이 제품을 출시했습니다.
2021년, 줄여서 EKSA.EKSA는 AWS 매니지드 쿠버네티스 또는 AWS 지원 쿠버네티스입니다.
인프라에서 실행되는 관리 소프트웨어
직접 관리합니다.그리고 EKSA는 작업을 간소화합니다.
인프라 프로비저닝 및 라이프사이클 관리
자체 하드웨어에 있는 쿠버네티스 클러스터.그리고 고객들이 우리에게 말했죠.
이제 이걸 사용할 수 있다는 게 정말 마음에 든다고 하더라고요.
AWS에서 지원하는 쿠버네티스 제품은 자체 인프라, 즉 자체 vSphere에서 제공됩니다.
베어 메탈이나 뉴타닉스 같은 것도 있겠지만, 그들은 우리에게 이렇게 말하기도 했습니다. “정말 좋아요,
하지만 소프트웨어 솔루션이긴 하지만 여전히 관리해야 합니다.”그래서 채택이 이루어졌습니다.
에어 갭 환경에서 실행해야 하는 사용 사례를 위해 EKS Anywhere를 도입했습니다.
또는 연결이 끊긴 환경.몇 가지 예를 들어보죠.
마치 Bare에서 실행되는 Telco 사용 사례와 같습니다.
최첨단의 메탈 또는 매우 엄격한 금융 서비스 사용 사례
온프레미스 네트워킹을 위한 네트워킹 요구 사항.하지만 이를 통해 우리는 다음과 같은 사실을 깨달았습니다.
여전히 고객 세그먼트이자 고객 유형입니다.
아웃포스트의 EKS와 EKS Anywhere의 이 두 가지 오퍼링으로는 이 문제를 해결할 수 없습니다.그리고 아직 다루지 못했던 고객 부문도
고객을 연결하기를 원하고 연결할 수 있는 고객입니까?
온프레미스 환경을 AWS에 연결하여 활용
클라우드 매니지드 서비스 및 온프레미스로 가져오기
클라우드에서 업무를 수행하는 방식에 더 잘 맞도록 관리하세요.그리고 이 모든 것이
어제 출시한 기능을 알게 되었어요.
EKS 하이브리드 노드라고 합니다.EKS 하이브리드 노드를 사용하면
기존 온프레미스 및 엣지 인프라 사용
EKS 클러스터의 노드로 사용할 수 있으므로 통합할 수 있습니다.
클라우드와 클라우드 모두에서 쿠버네티스를 관리하는 방법
온프레미스 환경.하이브리드 노드는 다음과 같을 수 있습니다.
관리하는 모든 물리적 또는 가상 머신과 함께 사용할 수 있으며 동일한 머신도 사용할 수 있습니다.
실행하는 데 사용하는 AWS 관리형 EKS 클러스터, 기능 및 도구
클라우드의 워크로드.간단히 말해서 더 이상은 필요 없습니다.
온프레미스 환경을 위한 Kubernetes 컨트롤 플레인 관리는 저희에게 맡기셔도 됩니다.
EKS 하이브리드 노드 사용.하이브리드 노드는 EKS 애드온, EKS 포드 아이덴티티 클러스터 액세스 항목 및 확장과 같은 다른 EKS 기능과 함께 사용할 수도 있습니다.
쿠버네티스 버전 지원.또한 다음과 통합되었습니다.
SSM 및 IAM 역할 애니웨어와 같은 기타 AWS 서비스는 다음과 같습니다.
임시 IAM 자격 증명 및 아마존 매니지드
중앙 집중식 모니터링 및 로깅을 위한 프로메테우스와 CloudWatch따라서 하이브리드 노드는 EKS 온프레미스 및 엣지 포트폴리오에 다시 적용하기 위해 연결을 할 수 있고 연결을 원하는 고객에게 적합합니다.
온프레미스 환경을 클라우드로, 새로 고칠 수 없는 고객에게도 적합합니다.
온프레미스 하드웨어를 사용하고 Outpost로 이전하려면 계속 진행해야 합니다.
현재 사용 중인 인프라 사용그래서 업계 전반에서 하이브리드 노드에 대한 관심을 보였고
다양한 사용 사례에서 말이죠.그리고 이런 것들이 많이 들어왔죠.
출시 전 몇 달 동안 프리뷰 기간 동안 말이죠.여기에서 이러한 사용 사례 중 몇 가지를 살펴보겠습니다.첫 번째는 엔터프라이즈 현대화입니다.따라서 현재 온프레미스의 가상 머신에서 실행 중이거나 자체 관리를 하고 있는 고객입니다.
또 다른 Kubernetes 솔루션인 이 고객들은 우리에게 이렇게 말했습니다. “들어봐, 우린 관리하고 싶지 않아.
쿠버네티스 컨트롤 플레인, 이걸 EKS 클러스터에 연결해서 작업을 끝내고 싶을 뿐이죠.”그래서 우리는 많은 것을 보았습니다.
기존 방식을 확장하고 표준화하려는 고객에 대한 관심
쿠버네티스를 온프레미스로 실행하세요.우리는 또한 많은 것을 보았습니다.
머신러닝 사용 사례를 보유한 고객의 관심.이러한 고객들은 우리에게 이렇게 말합니다.
이미 구입한 GPU와 호스팅 중인 GPU를 활용하고 싶어하는 고객
자체 온프레미스 환경, 그리고 그러한 환경을 실행하고 싶어하는 고객
클라우드에서 실행되는 워크로드에 사용하는 것과 동일한 클러스터의 GPU.이러한 고객 중 일부는 데이터센터 외부에서 전용 AI를 실행하는 것을 원하지 않으며, 일부는 그냥 실행만 하고 싶어하는 고객도 있습니다.
어디에 있든 GPU를 충분히 확보할 수 없습니다.그래서 이러한 고객들이 하이브리드 노드에 관심을 보이는 것을 볼 수 있었습니다.
말 그대로 온프레미스에서 작업을 실행하고 클라우드에서 작업을 실행할 수 있기 때문입니다.
동일한 EKS 클러스터를 사용합니다.여기서 마지막으로 말씀드릴 것은 제가 생각하는 모습입니다.
분산형 엣지 사용 사례.이 슬라이드에서는 미디어 스트리밍과 제조에 대해 살펴보겠습니다.이러한 고객에게 하이브리드 노드가 주는 이점은 바로 규모입니다.따라서 이러한 고객들은
배포는 보통 전 지역, 지리적으로 떨어져 있는 위치, 그리고 기존에는 각 사이트에서 별도의 Kubernetes 클러스터를 실행해야 했습니다.하이브리드 노드를 사용하면 다음을 수행할 수 있습니다.
각 사이트에 노드가 있는 단일 클러스터를 실행하거나 Amazon EKS의 규모에 의존하여 온프레미스에서 운영하는 다양한 배포를 모두 처리할 수 있습니다.따라서 출시에 앞서
Darktrace는 프리뷰에 참여한 고객 중 한 명이었습니다.잘 모르시겠지만, 다크트레이스는 글로벌 기업입니다.
사이버 보안 AI의 선두 주자로, 조직이 변화하는 위협에 미리 대비할 수 있도록 지원합니다.
매일의 풍경.Darktrace는 온프레미스에서 쿠버네티스를 사용하여 일반적인 배포 플랫폼을 제공하고 다양한 작업을 지원합니다.
애플리케이션 포트폴리오 전반의 공통된 옵저버빌리티, 애플리케이션 스케일링, 재해 복구 등이 이에 해당합니다.사이트 간 자체 관리 기능을 만드는 대신
Darktrace는 자체 개발 도구를 갖춘 Kubernetes 클러스터를 사용하기로 결정했습니다. Darktrace는 하이브리드 노드를 사용하기로 결정했고, 하이브리드 노드를 통해 서로 다른 곳에서 Kubernetes를 관리하는 방식을 통합할 수 있었습니다.
사이트 및 클라우드 및 온프레미스 환경 전반에서 높은 성과를 거두었습니다.
팀을 위한 가용성, 확장성 및 효율성소프트웨어도 여러 개 있었습니다.
하드웨어 파트너들이 기술을 검증합니다.
출시를 앞둔 하이브리드 노드와 함께한 가지 주의할 점은
EKS와 하이브리드 노드는 업스트림 쿠버네티스를 100% 준수한다는 것입니다.따라서 여전히 액세스할 수 있습니다.
주변에서 일어나고 있는 모든 혁신에 대해 알아보세요.
하이브리드 노드를 사용할 때의 쿠버네티스 커뮤니티.그리고 만약 있다면
제가 볼 수 있는 이 청중 가운데 파트너는
이번 출시에 참여해주셔서 진심으로 감사 드리며 정말 기대가 됩니다.
고객들이 만드는 멋진 제품들을 모두 확인해 보세요
당사의 공동 솔루션을 통해좋아요, 그럼 이제
기술적 측면을 좀 더 파헤쳐 보겠습니다.
이 새로운 기능에 대해서요.아키텍처부터 시작하여 AWS 지역에서 실행되는 EKS 컨트롤 플레인에 대해 살펴봤는데, 말 그대로
이전에 실행하던 것과 동일한 컨트롤 플레인입니다.
클라우드의 워크로드.하이브리드 노드의 경우 작업자 노드만
온프레미스에서 실행 중이며, 이 기능에서는 직접 가져올 수 있는 기능을 사용하고 있습니다.
인프라 접근 방식.따라서 우리는 어떤 인프라에도 손을 내밀어 전화를 걸지 않습니다.
사용자 환경의 API.계속 사용할 수 있습니다.
현재 사용 중인 기존 도구 및 시스템
해당 VM 또는 베어메탈 서버를 프로비전하려면
하이브리드 노드에서 용량으로 사용합니다.네트워크 연결
해당 EKS 클러스터에서 하이브리드 노드로 이동합니다.
EKS 클러스터 생성 중에 전달하는 VPC를 통해따라서 기존 버전을 재사용하고 있습니다.
오늘날 EKS에 있는 네트워킹 메커니즘이죠.그리고 실제로 핵심은
여기서 요구 사항은 EKS 클러스터로 전달하는 VPC와 온프레미스 환경 간의 연결입니다.
프라이빗 연결이며, 평가판 기간에 참여한 고객 대부분은 AWS Direct를 사용하고 있었습니다.
연결, AWS 사이트 간 VPN 또는 자체 VPN 솔루션
해당 연결을 위해서요.EKS 클러스터에서 이러한 작업자 노드를 인증하기 위해 임시 IAM을 사용하고 있습니다.
SSM 하이브리드 활성화에 의해 프로비저닝되는 자격 증명
또는 어디서나 사용할 수 있는 IAM 역할.그래서 우리가 만든 도구, 즉 좀 더 자세히 설명하겠지만, 이러한 시스템과 통합되어 중앙 집중화가 가능합니다.
ID 관리 및 인증
EKS 클러스터는 모두 IAM에 있습니다.좋아요, 이제 다음으로 넘어가겠습니다.
공동 책임 모델, 간단히 말해서, 우리는 다음을 관리합니다.
클라우드에서 모든 것을 온프레미스로 관리할 수 있습니다.구성 요소를 지원합니다.
하이브리드 노드 CLI와 함께 설치되는 것은
이를 nodeadm이라고 합니다.이러한 구성 요소에는 컨테이너, kubelet, SSM, IAM Roles Anywhere는 물론 다음과 호환되는 쿠버네티스 애드온이 포함됩니다.
하이브리드 노드 출시 시점여기에는 kube-proxy, CoreDNS, CNI, 칼리코 또는 실리움, OpenTelemetry용 AWS 배포판 애드온, CloudWatch 옵저버빌리티 애드온, EKS 포드 아이덴티티 애드온이 포함됩니다.따라서 여기서 중요한 것은 여전히 여러분에게 책임이 있다는 것입니다.
온프레미스 인프라를 위해서죠.따라서 하드웨어는
가상화, 네트워킹, 스토리지 및 해당 운영
시스템 프로비저닝은 사용자의 책임입니다.선택한 도구를 해당 관리에 계속 사용할 수 있으며, 당사는 관리하거나 지원합니다.
사용자 환경에서 실행되는 스택 위의 항목을 확인한 다음 해당 지역에서 실행되는 항목을 관리합니다.
예를 들어 EKS 컨트롤 플레인, 옵저버빌리티 및 아이덴티티 서비스, 그리고 일부
Amazon ECR과 같은 기타 보조 서비스를 위한
컨테이너 레지스트리.자, 요약하자면, 종류
갖춰야 할 핵심 전제조건은
네트워크 연결 측면에서 하이브리드 노드를 사용하려면 사설이어야 합니다.
VPC에서 온프레미스 환경으로의 연결.인프라 레이어에서는 자체 인프라를 가져와 베어 메탈 서버, VMware 가상 머신, Nutanix 인프라를 사용할 수 있습니다.
저희는 상관하지 않습니다.여기에서 출시 시 하이브리드 노드와 함께 x86 또는 ARM 아키텍처를 사용할 수도 있습니다.운영 체제의 경우 여기에 나열된 세 가지 운영 체제는 다음과 같습니다.
하이브리드 노드와 호환되며 AWS에서 인증을 받았습니다.
출시 당시의 호환성.우분투, 레드햇 엔터프라이즈 리눅스, 아마존 리눅스 2023아마존 리눅스 2023은 온프레미스의 가상화된 환경에서만 사용할 수 있습니다.그리고 자격 증명으로
하이브리드 노드에서 실행되는 kubelet을 인증하기
EKS 클러스터에서는 임시 IAM 자격 증명을 사용하고 있으며 둘 중 하나를 사용해야 합니다.
매니저 하이브리드 활성화 또는 IAM 역할 애니웨어
해당 자격 증명에 사용됩니다.좋아요, 그럼 이제 더 깊이 들어가 볼까요?
EKS에서 어떻게 보이는지, 클러스터 경험을 만들고 네트워킹이 어떻게 되는지에 대해서도 알아보겠습니다.
더 심층적인 수준에서 작동합니다.따라서 클러스터를 생성하면 보통 다음과 같습니다. 맨 아래에 있는 보라색 상자를 제외하고는 콘솔에 새 섹션이 있는데, 이는 원격 구성을 위한 새 API 필드에 해당합니다.
하이브리드 노드용 네트워크.그리고 이걸 활성화하면
콘솔에서 토글하면 다음과 같은 메시지가 나타납니다.
이 두 개의 새로운 분야는 원격 노드 네트워크입니다.
그리고 이 리모트 포드 네트워크.이들은 트래픽을 라우팅하는 데 사용됩니다.
AWS 서비스에서 실행되는 EKS 컨트롤 플레인에서
클러스터 생성 중에 전달한 VPC에 계정을 할당합니다.노드 네트워크가 사용됩니다.
kubectl 로그와 같은 쿠버네티스 오퍼레이션의 경우,
kubectl exec 포트 포워드와 여기의 포드 네트워크는 다음과 같습니다.
선택 사항이지만 권장됩니다.선택 사항이므로 선택 사항입니다.
웹훅을 실행하는 경우에만 정말 필요합니다.
하이브리드 노드와 쿠버네티스 컨트롤 플레인에서
다음과 같은 웹훅에 직접 연결해야 합니다.
하이브리드 노드에서 실행.따라서 웹훅을 실행하지 않는 경우에는 이 기능을 활성화하지 않아도 되지만, 일반적으로 웹훅을 사용하는 것이 좋습니다.
쿠버네티스 애드온은 웹훅을 사용합니다.좋아요, 이제 종단간 흐름에 대해 알아보겠습니다.
쿠버네티스 컨트롤 플레인에서 하이브리드 노드에 이르기까지 네트워킹이 어떻게 작동하고 백업되는지 말이죠.방금 다루었습니다.가장 먼저 말씀드리자면, 이 첫 번째는 원격 네트워크 구성과
원격 포드 네트워크 구성은 다음과 같은 경우에 구성됩니다.
EKS 클러스터를 생성합니다.이는 통신을 용이하게 합니다.
컨트롤 플레인에서 전달한 VPC로
클러스터 생성 중다음으로 필요한 것은
이 VPC 라우팅 테이블이 바로 여기에 있습니다.구성해야 합니다.
원격 노드 네트워크와 원격 포드 네트워크
해당 VPC를 종료하는 데 사용하는 게이트웨이 경로가 포함되어 있습니다.일반적으로 이것은 전송 게이트웨이 또는 가상 프라이빗 게이트웨이이지만 다른 것도 있습니다.
그 방법도 있습니다.중요한 건
이 두 경로가 해당 라우팅 테이블에 있어야 한다는 것입니다.따라서 트래픽이 VPC를 빠져나가는 지점에 도달하면 이제 온프레미스 환경으로 넘어갑니다. 다음 단계는
온프레미스 라우팅 테이블은 다음과 같이 구성해야 합니다.
동일한 원격 노드 네트워크와 선택적으로 원격 포드 네트워크를 통해 해당 트래픽이 온프레미스 환경에 도달하면 해당 트래픽이 전송 시 어디로 이동해야 하는지 알 수 있습니다.
하이브리드 노드로 향하는 트래픽.그리고 마지막 부분은
여기서 중요한 것은 CNI입니다.이건 좀 미묘한 부분이기 때문에 그냥 넘어가겠습니다.
여기서 간단히 설명해 주세요.당신이 가지고 있는 포드 CIDR
오버레이 네트워크를 사용하는 경우 CNI에서 구성할 수 있는 항목은 다음과 같아야 합니다.
클러스터에서 구성한 원격 포드 네트워크도 동일해야 합니다.해당 CNI 계층에서 사용할 수 있는 추가 구성이 있습니다. 예를 들어 발신되는 포드 트래픽이 온프레미스 호스트를 벗어날 때 포드 트래픽을 차단합니다 (이 경우 포드).
라우터가 중요하기 때문에 CIDR은 그다지 중요하지 않습니다.
노드로 라우팅하면 CNI가
트래픽을 파드로 보내는 걸 알아서 할 거야.하지만 그 때문에 저는 떠나겠습니다.
설명서로 넘어가는 대신 문서로 넘어가세요.
여기에서 자세히 알아보세요.한 가지 더 추가하고 싶은 것은 양측의 네트워크 액세스가 제자리에 있어야 한다는 것입니다.
방화벽이 양방향 통신을 허용해야 합니다.
EKS 컨트롤 플레인 및 보안 기능 포함
여기에 추가한 그룹 중 연결될 그룹
EKS가 VPC와의 통신에 사용하는 ENI.해당 보안 그룹에는 다음이 필요합니다.
해당 수신 및 발신 트래픽을 활성화하려면
원격 포드 네트워크 및 원격 노드 네트워크좋아요, 이제 말씀드리자면
뭐, 뭐, 뭐, 뭐에 대한 얘기 좀 해볼까요
최소 네트워킹 요구 사항은?당연히 상황에 따라 다르다는 것을 말씀드려야겠네요. 알겠죠?자체 환경과 자체 애플리케이션으로 테스트해야 합니다.우리는 상당한 양의 작업을 수행했습니다.
출시를 앞두고 테스트를 진행했는데, 여기서 이미 다룬 프라이빗 연결 외에도 100메가비트 이상의 안정적인 연결을 권장합니다.
초당 대역폭, 그리고 일반적으로
컨트롤 플레인 간의 지연 시간이 짧을수록
그리고 하이브리드 노드는 더 나은 경험을 제공합니다.
이제 사용할 수 있을 거예요. 이보다 더 좋은 건 추천하지 않아요.
200밀리초 이상의 왕복 지연 시간
컨트롤 플레인과 하이브리드 노드 사이상황에 따라 다릅니다.많은 것들에 따라 달라지죠.숫자에 따라 다릅니다.
보유한 노드 수.얼마나 큰지에 따라 다릅니다.
애플리케이션 이미지는고객에 따라 다릅니다.
애플리케이션 종속성AWS 서비스에 액세스하고 있습니까?그렇다면 얼마나 많은 데이터를 보내고 있습니까?탄력성에 따라 달라집니다.
워크로드 수.포드를 돌리고 계신가요?
위로, 아래로 돌리나요?노드를 돌리고 계신가요?
위로, 아래로 돌리나요?그리고 그게 뭐냐에 따라 달라지기도 하죠
모니터링에 사용하고 있습니다.얼마나 많은 데이터를 보내고 계신가요?
하이브리드 노드부터 해당 지역의 잠재적으로 아마존 매니지드 프로메테우스 또는 CloudWatch까지.이 모든 것이 가능하죠.
최소값이 무엇인지에 관해서라면 말이죠.
네트워킹 요구 사항이므로 테스트하는 것이 좋습니다.이 슬라이드의 그림을 출발점으로 삼아야 합니다.자, 네트워킹에 대해 알아보았으니 이제 다음으로 중요한 부분을 살펴보겠습니다.
사용자 경험 중 하나는 하이브리드 노드 명령줄 인터페이스입니다.그리고 그 방법에 대해 말씀드렸습니다.
하이브리드 노드는 직접 만들어 보는 것처럼 구현됩니다.
인프라 접근 방식, 그것이 바로 여러분의 몫입니다
해당 인프라를 구성하고 관리하는 책임
및 하이브리드 노드와 함께 사용하는 운영 체제.Nodeadm은 운영 체제 상단에서 실행되는 부분으로 정말 간단합니다.
하이브리드 노드의 라이프사이클 관리.그리고 nodeadm에 대한 영감은 실제로 사용 중인 EKS AMI에서 비롯됩니다.
클라우드에서 실행되는 작업자 노드용입니다.AL2023 EKS AMI에서는
노드 애덤도 있습니다.그래서 우리가 한 일은 그 도구를 가져다가 제대로 작동하도록 조정한 것입니다.
다른 인프라 및 기타 운영 체제와 함께 사용할 수 있을 뿐만 아니라 SSM 및 IAM Roles Anywhere와도 통합하여 이제 온프레미스에서도 이와 동일한 도구를 사용할 수 있습니다.
하이브리드 노드를 위한 환경.권장 사항은 다음과 같습니다.
이 도구를 사용하여 운영 중에 nodeadm 설치 프로세스인 init's를 실행하십시오.
모든 것을 풀다운하기 위한 시스템 빌드 파이프라인
호스트를 하이브리드 노드로 변환하는 데 필요한 종속성그러면 다음 중 하나를 수행할 수 있습니다.
noreadm init가 시스템 서비스로 실행되도록 구성하거나 운영 체제 부팅 시 선택한 도구를 사용하여 noreadm init를 시작할 수 있습니다.이를 통해 실제로
하이브리드 부트스트래핑의 엔드-투-엔드 흐름을 자동화하세요.
노드에서 EKS 클러스터까지대부분의 사람들은
먼저 시도해 보세요. 네, 다음과 같이 사용할 수 있습니다.
그냥 일반적인 구식 CLI이지만, 다시 말씀드리지만, 이 방법을 사용하는 것이 좋습니다.
하이브리드 노드를 부트스트래핑하는 프로세스를 자동화하면 이런 것들을 골든 운영 체제 이미지에 베이크할 수 있습니다.제가 여기서 보여드리는 것은 이 nodeadm이 무엇인지에 대한 예시입니다.
init 명령은 다음과 같습니다.이 명령을 실행하기 전에 모든 종속성을 가져오는 install 명령을 실행해야 합니다.현재 진행 중인 작업은 Noreadm init입니다.
이러한 의존성을 시작하는 것이야말로 장점인 셈이죠.
이러한 임시 IAM 자격 증명은 EKS에 연결됩니다.
구성한 클러스터.왼쪽 부분에
이 슬라이드의 예는 SSM 하이브리드 활성화의 예입니다.클러스터를 통과하면 됩니다.
이름을 지정하고 해당 지역을 통과한 다음 활성화를 전달합니다.
코드 및 활성화 ID.이 두 값은 SSM 하이브리드 활성화를 생성할 때 얻을 수 있는 값입니다.기본적으로 SSM은 다음을 사용합니다.
토큰으로 교환하고 임시 IAM 자격 증명을 가져오면 SSM이 디스크에서 해당 자격 증명의 순환을 관리합니다.이 슬라이드의 오른쪽에는 IAM Roles Anywhere의 예제가 나와 있습니다. 다시 말씀드리지만 클러스터 이름, 클러스터 지역, 그리고 몇 가지가 있습니다.
여기에 있는 더 많은 값은 모두 임시 자격 증명을 기반으로 합니다.
프로비저닝 프로세스는 IAM Roles Anywhere에서 작동합니다.IAM 역할 애니웨어는 a를 사용하고 있습니다.
인증서 기반 메커니즘, 인증서 교환
임시 IAM 자격 증명용.따라서 일반적으로 말하자면, 사용하지 않는 경우와 같습니다.
컴퓨터 ID 또는 사용자 내 인증을 위한 인증서
온프레미스 환경에서 SSM은 약간씩 다를 수 있습니다.
시작하기는 더 쉽지만 인증서를 사용하는 경우 하이브리드 노드 인증에도 해당 인증서를 계속 사용할 수 있습니다.좋아요, 그럼 이제 끝내고
하이브리드 노드를 EKS 클러스터에 연결하세요. 이것이 바로 이들이 할 일입니다.
콘솔의 모습이나 kubectl get nodes처럼 실행했다면 다음과 같이 보일 것입니다.한 가지 말씀드리고 싶은 게 있어요.
여기 이 노드 이름이 있네요.하이브리드 활성화로 노드를 부트스트랩하면 SSM에서 자동으로 프로비저닝합니다.
SSM용으로 구성한 것입니다.이 노드 이름은 현재 구성할 수 없습니다.SSM을 사용하는 경우
에서 구성할 수 있어야 하는지 알려주세요.
미래와 대화할 수 있어요.하지만 맨 아래에 있는 이 노드에는 IAM Roles Anywhere 프로비전 노드가 있습니다.IAM Roles Anywhere를 사용할 때 해당 노드 이름을 구성할 수 있습니다.해당 노드 이름은 다음과 같은 속성과 일치해야 합니다.
임시 IAM 자격 증명과 교환하는 데 사용하는 인증서에 있습니다.새로 추가한 것이 하나 있습니다.
이 컴퓨팅 유형 열이 콘솔에 있었나요?나도 전화해 보고 싶었어
nodeam을 사용하면 자동으로 적용된다는 것
하이브리드 노드에 레이블을 지정하면 해당 컴퓨팅을 사용할 수 있습니다.
유형은 워크로드 배치를 위한 하이브리드 레이블과 같습니다.따라서 하이브리드 노드에서만 실행하고 싶은 항목이 있는 경우 바로 사용할 수 있는 레이블을 사용하여 해당 항목을 확인할 수 있습니다.
기존에 있을 수도 있는 클라우드 노드 대신 하이브리드 노드에서만 실행됩니다.
동일한 EKS 클러스터.이 슬라이드는 기본적으로 하이브리드에 있는 리소스도 볼 수 있다는 것을 보여주기 위한 것입니다.
EKS 콘솔의 노드.아래로 스크롤하면
콘솔의 이 페이지에서는 포드, 레이블, 해당 노드에 대한 모든 종류의 세부 정보를 볼 수 있습니다.또한 SSM을 사용하는 경우 Fleet Manager에서 노드를 볼 수 있으며 다음과 같은 작업을 수행할 수 있습니다.
다음과 같은 경우 하이브리드 노드와 함께 SSM 내장 오퍼레이션을 사용할 수 있습니다.
자격 증명 공급자를 위한 SSM 하이브리드 활성화 사용.좋아요, 그럼 이제
출시 당시 사용할 수 있는 기능을 살펴보세요. 범위는 다음과 같습니다.
어제 출시했습니다.현재 하이브리드 노드는
중국 지역의 GovCloud를 제외한 모든 AWS 지역에서 사용할 수 있으며 현재 사용할 수 있습니다.
새 EKS 클러스터에만 해당됩니다.기존 EKS 클러스터에 하이브리드 노드를 활성화하기 위해 노력하고 있습니다.
하지만 지금은 아직 준비되지 않았습니다.그게 준비됐으면 좋겠어요.
곧 내년 1분기가 되겠네요.같은 것을 사용할 수도 있습니다.
표준 및 확장 지원을 모두 지원하는 EKS 쿠버네티스 버전쿠버네티스에 대한 표준 지원
EKS 버전은 14개월이며 이후 지원 연장
특정 기간 동안 추가 12개월에서 해당 14개월 동안의 광고
쿠버네티스 마이너 버전.EKS 클러스터를 관리할 때 사용하는 것과 동일한 인터페이스
하이브리드 관리에도 사용할 수 있습니다.
노드 지원 EKS 클러스터.콘솔, CLI, eksctl, API, 클라우드포메이션, 테라폼 등을 사용할 수 있습니다. 현재 모두 사용할 수 있습니다.EKS 클러스터 액세스를 사용할 수 있습니다.
하이브리드 노드가 있는 항목.여기서 다루지 않은 한 가지는 새로운 액세스 권한이 있다는 것입니다.
다음과 같은 용도로 사용할 수 있는 Hybrid Linux라는 엔트리 타입
인증에 사용하는 하이브리드 노드 IAM 역할
EKS 클러스터가 있는 하이브리드 노드.EKS 클러스터의 경우
생성하려면 구성 맵에서 API 또는 API를 다음과 같이 사용해야 합니다.
EKS 클러스터의 인증 모드.슬라이드의 마지막 부분인 혼합 모드 EKS 클러스터를 실행할 수 있습니다.따라서 단일 EKS를 사용할 수 있습니다.
일부 노드는 EC2에 있고 일부 하이브리드 노드는 자체 온프레미스 환경에서 실행되는 클러스터입니다.또한 한 가지 기능을 발표했습니다.
어제 EKS 자동 모드라고 불렀는데, EKS 자동 모드와 하이브리드 노드를 사용하는 단일 EKS 클러스터를 사용할 수도 있습니다.
동일한 클러스터에서IPv4를 지원하고 있습니다.
여기서는 출시 시에만 가능합니다.앞서 말씀드렸듯이 저희는 Cilium을 지원하고 있고
캘리코는 포드 네트워킹용입니다.VPC CNI는 사용할 수 없지만 커뮤니티 기반의 이 두 가지에 대해서는 AWS로부터 지원을 받을 수 있습니다.
하이브리드 노드 사용 시 CNI.코어 네트워킹 하이브리드 노드 또는 코어 네트워킹 애드온은 다음과 같습니다.
하이브리드 노드에 사용할 수 있으므로 kube-proxy뿐만 아니라 CoreDNS도 사용할 수 있습니다.서비스 계정에 파드 아이덴티티와 IAM 역할을 사용할 수도 있다.그리고 그 외 모든 것
EKS 애드온으로 사용할 수도 있는
옵저버빌리티는 EKS 하이브리드 노드에서도 지원되므로 Amazon 매니지드 프로메테우스는
에이전트가 필요 없는 지표, ADOT 에이전트,
하이브리드 노드 모니터링을 위한 CloudWatch 에이전트이자 EKS 클러스터 컨트롤 플레인의 컨트롤 플레인 로깅으로도 사용할 수 있습니다.마지막으로 다음을 사용할 수도 있습니다.
GuardDuty EKS 프로텍션: 감사를 살펴봅니다
EKS 클러스터를 기록하고 취약점을 분석합니다.빠르게 설명해 드릴게요.
다음은 몇 가지 모범 사례입니다.제가 이것들을 다루고 있는 이유는
언젠가는 머릿속에서 “내가 이걸 해야 하는 거 아닌가요?” 와 같은 생각이 들었으면 좋겠어요.이 내용에 대한 자세한 내용은 저희 문서에 많이 나와 있습니다. 그래서 저는
실제로 어떻게 하는지 보려면 해당 내용을 확인해 보는 것이 좋습니다.
이것들을 실천에 옮기세요.첫 번째로 말씀드린 것은 노드 부트스트랩을 자동화하는 것이었습니다.다음과 같은 경우에는 nodeadm을 CLI로 실행하지 마세요.
이걸로 제작할 수 있어요.다음과 같이 골든 이미지를 만들어 보세요.
종속 항목을 포함하고 EKS에 연결하도록 nodeadm을 구성합니다.
호스트 시작 시 클러스터두 번째는 지연 시간이 짧다는 것입니다.
더 나은 경험.가장 가까운 AWS 리전을 사용하세요.
하이브리드 노드를 사용하는 경우 온프레미스 환경.“AWS 지역 사용”이란, 다음을 생성한다는 뜻입니다.
가장 가까운 AWS 리전의 클러스터
온프레미스 환경.네트워킹과 함께 작업하세요
그리고 보안 팀. 우리가 본 문제의 90%
프리뷰 기간 동안에는 다음과 관련된 문제가 있었습니다.
방화벽이나 네트워킹 같은 트래픽 경로에 있는 것 말이에요.그러니까 이걸 배포할 거면 남자나 여자에게 핑을 보내세요
누가 여러분의 네트워킹 제품을 소유하고 있고 그들과 좋은 관계를 형성할 수 있을까요? 왜냐하면 그것은 정말로
성공의 핵심 요소.VPC 측면에서 또 다른 부분은 제가 이 제품을 사용하면서 개인적으로 놀랐던 한 가지는 EKS 클러스터의 보안 그룹입니다.VPC에 원격 노드 네트워크의 루트가 있는지 확인하세요.
그리고 원격 포드 네트워크와 EKS 클러스터의 보안 그룹이 송수신 트래픽을 허용하는지 확인하세요.
하이브리드 노드에서.마지막으로, 적용할 라벨에 대해 말씀드렸는데요.
기본적으로 하이브리드 노드로, 컴퓨팅 유형은 하이브리드로, 워크로드 배치에 사용합니다.어떤 상황에서든 의도적으로 행동하세요.
워크로드가 실행되기를 원합니다.포드가 한 노드에서 다른 노드로 이동할 때 골치 아픈 일이 생길 수 있습니다. 그리고 포드가 한 노드에서 다른 노드로 이동했을 뿐만 아니라 사용자 노드에서 다른 노드로 이동했다는 사실을 알게 될 것입니다.
데이터 센터에서 클라우드로, 마치...엉망이 될 수도 있어요.좋아요. 다른 하나는 AWS 통합을 활용하는 것입니다.우리가 이 과정을 진행하는 많은 이유가 있습니다.
이렇게 다양한 애드온에 대한 많은 검증은 저희가 직접 사용하고 싶어하기 때문입니다.
그건 이제 잊어버리세요.저희가 엄청 큰 테스트를 거쳤던 것들을 여러분들이 사용해 주셨으면 좋겠어요.
매트릭스는 내부적으로 사용되고 있으며 지원하고자 합니다.
AWS 서비스와의 통합이 가능합니다.그리고
온프레미스 자산을 클라우드에서의 작업 방식에 더 잘 맞출 수 있는 가장 좋은 방법입니다.여기서는 EKS 클러스터를 가리킵니다.
쿠버네티스 API 엔드포인트.퍼블릭을 사용하는 것이 좋습니다.
또는 프라이빗 엔드포인트 액세스.퍼블릭 및 프라이빗 엔드포인트 액세스는 사용하지 않는 것이 좋습니다.그 이유는 다음과 같습니다.
하이브리드 노드가 VPC 외부에서 실행되고 있는 경우
해당 엔드포인트, 즉 쿠버네티스 API 엔드포인트는 퍼블릭 IP로 확인될 것입니다. 그러면 다음과 같은 결과가 발생할 수 있습니다.
놀라운 행동.따라서 프라이빗 연결을 원한다면 프라이빗 연결을 사용하고 둘 다 사용하지 마세요.이는 특히 혼합 모드 클러스터를 실행하는 경우를 가리킵니다.따라서 일부 노드가 실행 중이라면
EC2의 일부 하이브리드 노드에서는 다음 조건을 충족해야 합니다.
각 위치에 CoreDNS 복제본이 하나 이상 있습니다.이는 해당 요청을 해결하기 위한 것이지만, 다음과 같은 경우에도 마찬가지입니다.
서비스 중단이 발생해도 해당 담당자에게 계속 연락할 수 있어야 합니다.
클러스터 내 서비스.여기 있는 건 형편없어요.
슬라이드에 적혀 있지만 구역 레이블을 사용하세요.데이터 센터가 두 개 있다고 가정해 보겠습니다.한 데이터 센터에 노드가 있고 다른 데이터 센터에 노드가 있는 경우 Kubernetes에서 사용하므로 해당 노드에 Kubernetes 토폴로지 영역 레이블을 지정하세요.
네트워크 연결이 끊어지는 동안 노드 도달 가능성을 평가할 때 사용하는 영역 정보인데, 이 정보가 확인되면 그 안에 있는 모든 노드를 예로 들어 보겠습니다.
영역에 도달할 수 없는 경우 쿠버네티스 컨트롤 플레인은 이렇게 말할 것입니다. “좋아요, 이런 파드를 하나도 제거하지 마세요.그냥 놔두세요.뭔가 분명해
그 구역이 엉망이 됐어요.”따라서 하이브리드 노드를 구성할 때 해당 영역 레이블을 사용하세요.마지막으로 소개하는 것이 일반적으로 권장되는 내용입니다.
롤링 업그레이드를 수행하여 새 Kubernetes 버전에서 새 하이브리드 노드를 프로비저닝한 다음 기존 Kubernetes 버전에서 하이브리드 노드를 종료합니다.이는 일반적으로 더 안전한 기술이지만, 지원 기능도 제공합니다.
nodeam을 사용한 인플레이스 업그레이드.마지막으로 여기에 덧붙여 말씀드린 내용은 사용하지 않는 노드를 반드시 삭제하라는 것입니다.우리는 이것들을 측정하고 있습니다.하이브리드 노드를 사용하려면 비용이 들기 때문에 사용하지 않는 경우 놀라지 않도록 반드시 삭제해야 합니다.
청구서에 기재된 요금에 따라그럼 존한테 노스웨스턴 뮤추얼에 대해 얘기할게요. - 멋지네요.고마워요 크리스.모두들 내 말 들리나요?멋지네요.그래서 저는 엔지니어링 담당 수석 이사인 존 오그던입니다.
노스웨스턴 뮤추얼에서 말이죠.제 책임은 저에게 있습니다.
우리의 모든 클라우드 플랫폼, 그리고 여기에는 모든 컨테이너가 포함됩니다.
그리고 쿠버네티스 시스템.한 번 봅시다.하지만 시작하기 전에 먼저 이야기를 좀 해야겠네요.
노스웨스턴 뮤추얼에 대해서요.혹시 모르시는 분들을 위해 말씀드리자면, 노스웨스턴 뮤추얼은
금융 서비스 회사.우리의 유일한 초점은 무료에 있습니다.
경제적 불안감에서 벗어나는 미국인들재미있는 사실인데요, 1850년대 중반에 일어난 일입니다.
우리 회사가 설립되었을 때 위스콘신은 북서부였습니다.
미국의 회사죠.그렇게 우리의 이름을 얻게 되었죠.저희는 상장 기업이 아니에요.당사의 보험 계약자는 거의 5백만 명에 달합니다.
우리의 주식 소유주입니다.그래서 모든 달러 하나하나가
우리가 창출하는 수익은 고객에게 돌아가고 궁극적으로는 고객을 위해 돌아갑니다.
재정적으로 더 안전합니다.따라서 당사의 리스크에 관심이 있으시다면
웰스 매니지먼트 상품은 northwesternmutual.com을 확인하거나 당사 제품 중 한 곳으로 문의하시기 바랍니다.
현지 재정 고문과 이들이 시작하는 데 도움을 줄 수 있습니다.하지만 우린 여기서 얘기하러 온게 아니에요
금융 서비스에 대해 말씀드리려고 합니다.
우리의 쿠버네티스 여정.그래서 우리는 약 9년 전에 쿠버네티스를 어려운 방법으로 사용하기 시작했습니다.우리는 쿠버네티스로 시작했습니다.
0.9는 EC2 인스턴스에 배포되었습니다.이 모든 것은 데이터를 통합하기 위한 마이크로서비스 허브에서 시작되었습니다.
당시 인수한 LearnVest라는 신생 기업에 온프레미스 데이터 센터를 운영했습니다.한동안은 효과가 있었지만 모든 것이 성공적이었듯이
그린필드 프로젝트는 결국
엔터프라이즈 플랫폼.그래서 2018년에 우리는 우리의 제품을 출시했습니다.
공식 클라우드 플랫폼.비즈니스의 모든 영역을 시작할 수 있었습니다.
애플리케이션을 현대화하고 클라우드로 이전하세요.그 시점인 2021년에는
수천 개의 마이크로서비스, 마이크로 애플리케이션
비즈니스의 거의 모든 영역을 운영하고 있습니다.그 외에도 다른 곳도 많이 있었습니다.
자체 Kubernetes 클러스터를 운영하는 회사 내 여러 팀과 다른 많은 팀들도 이 작업이 얼마나 어려운지 알게 되었습니다.
안정성을 유지하고, 보안을 유지하고,
규정 준수.그래서 결국 우리는
이들을 모두 단일 컨테이너 플랫폼 팀으로 통합했습니다.또한 모든 것을 EKS로 마이그레이션했습니다. 모든 컨트롤 플레인을 유지 관리하고 운영하는 것도 원하지 않았기 때문입니다.1년 후, 우리는 조종기가 필요하다는 것을 알게 되었습니다.
온프레미스 쿠버네티스 솔루션.우리는 큰 성공을 거두었습니다.
클라우드 기반 솔루션으로 래핑을 시작하고 싶었습니다.
일부 레거시 데이터 센터, 메인프레임과 같은 데이터 자산
마이크로서비스 셸에서 말이죠.하지만 이 작업은 조금 다른 방식으로 진행되었습니다. 다른 팀, 다른 도구, 다른 방식으로 진행되었죠.그래서 지난 2년 동안 저희는 정말 시작했어요.
온프레미스 환경을 클라우드 경험으로 최적화, 확장 및 통합해 보세요.이것이 바로 EKS입니다.
하이브리드 노드가 등장합니다.당사의 클라우드 플랫폼은
이 6가지 전략적 테마를 우리는 6S라고 부릅니다.안정성, 보안, 표준화, 단순화, 지출, 그리고 제가 가장 중요하게 생각하는 것은
중요한 것은 인력 배치입니다.EKS 하이브리드에 대해 이야기하면서 살펴보도록 하겠습니다.
우리가 가지고 있는 이러한 전략적 주제 하나하나에 모두 들어맞습니다.그럼 우리의 현재 상태는 어떤가요?
온프레미스 데이터센터의 모습은요?그래서 우리는 다음과 같은 사치를 누릴 수 있습니다.
같은 밀워키 대도시 지역에 두 개의 데이터 센터가 있어서 매우 저렴한 가격을 제공합니다.
두 데이터 센터 간의 지연 시간 네트워킹
이를 통해 스팬 네트워크에서 실행할 수 있게 되었습니다.
꽤 오랫동안 설정을 했었죠.또한 스토리지와 컴퓨팅 플랫폼에 메트로 클러스터링을 많이 사용합니다.실제로 두 개의 데이터 센터도 마찬가지입니다.
마치 하나의 데이터 센터처럼 보이는데, DR 및 복구와 같은 것이 아니라 고가용성에 더 중점을 두도록 구성된 것입니다.쿠버네티스도 사용합니다.
쿠버네티스를 관리하기 위해서입니다.그래서 쿠버네티스 관리 플레인이 있고 각 클러스터는 이 두 데이터 센터 사이에 위치합니다.모두가 알고 있듯이 etcd를 사용하고 쿼럼을 유지하려고 하면 홀수를 둘로 나눌 수 없습니다.그 데이터 중 하나는
문제 발생 시 센터 운영이 중단될 수도 있습니다.그래서 방금 말씀드린 것처럼 문제가 생겼습니다.하나라도 잃으면 어떻게 되나요?
우리 데이터 센터 두 곳 중 하나요?컨트롤 플레인이 작동합니다.
읽기 전용 모드에서는 워크로드가 계속 실행되지만 변경할 수는 없습니다.앱 팀이 뭔가를 고쳐야 할 수도 있는데, 아직 준비가 안 됐을 수도 있습니다.그래서 etcd를 복원해야 합니다.
전체 데이터 센터 가동 중단 시 쿼럼과 컨트롤 플레인.기본 데이터 센터를 잃게 되면 어떻게 될까요?관리 플레인도 잃어버리면 복구해야 합니다.
컨트롤 플레인과 작업자 노드를 복구하기 전에 관리 플레인을 다시 동기화하세요.작년 말 즈음에
회사는 기본 데이터 센터 시설을 매각하고 철수하기로 결정했고, 우리는 6~800마일 떨어진 콜로 시설로 이전하기로 결정했습니다.
현재 우리가 있는 곳에서요.또한 운영 오버헤드도 많습니다.또한 패치도 해야 하고
모든 클러스터와 관리 플레인도 유지 관리합니다.여러분 중 일부는 이렇게 생각할 수도 있습니다. “음, 해결하기는 쉽지만,
클러스터를 세분화하고 각각 실행하기만 하면 됩니다.
데이터 센터를 독립적으로 운영합니다.”뭐, 패치와 유지보수에 필요한 모든 것이 두 배로 늘어난다는 거죠.그래서 더 나은 솔루션이 필요했습니다.우리는 그 이유에 대해 이야기를 나누기 시작했어요.
현재 플랫폼을 세분화하는 것이 반드시 최선은 아닙니다.
선택 사항이긴 하지만 이미 있습니다.또한 온프레미스 플랫폼도 폐기하고 모든 것을 클라우드로 푸시하기만 하면 됩니다.AWS는 그걸 좋아할 거예요.하지만 우리에겐 많은 데이터가 있습니다.
중력 및 지연 문제는 계속 유지해야 합니다.
일부 워크로드는 정말 긴밀하게 연결되어 있습니다.
그 데이터 센터들로요.EKS Anywhere로 대체할 수도 있겠지만, 현재는 사용하고 있지 않습니다.아주 좋은 제품이긴 하지만 계속 패치를 해야 할 수도 있고
컨트롤 플레인을 유지하세요.모든 훌륭한 엔지니어링 팀들처럼 저도 맞춤형 제품을 만들어 보고 싶어요.사실 여기서 약 1년 반 전에 크리스를 만났어요.AWS 계정 팀에 연락해서 이렇게 물었습니다. “픽시 부팅을 시작하면 어떻게 될까요?
kubelet과 IAM Anywhere를 사용하는 베어 메탈의 리눅스 박스, 이걸 제대로 할 수 있을까요?”그러자 크리스가 제게 전화를 걸었고 그는 이렇게 말했습니다. “할 수 있잖아요.
엄밀히 따지자면 그렇게 하겠지만 추천하고 싶지도 않고 확실히 지원되지도 않아요. 아마 프로덕션 환경에서는 별로 효과가 없을 거예요.”그래서 저는 별로 하고 싶지 않아요.
그렇지 않은 플랫폼을 실행하세요...다음과 같은 프로덕션 플랫폼
공급업체에서 지원하지 않습니다.그래서 작년에 시카고의 KubeCon에서 크리스와 만났어요.
그리고 그의 엔지니어 한 명이요.우리는 잠재적인 요구 사항의 목록을 살펴보기 시작했습니다.
CNI가 어떤 종류인지 아세요?네트워크는 어떻게 설정되어 있나요?어떤 OS를 사용하시나요?그리고 그들이 말하길
뭔가 작업 중이네요그들은 어떤 약속도 할 수 없지만 뭔가를 해내고 있어요.그래서 생각하게 됐어요. 만약 그들이 문제를 다음과 같이 해결할 수 있을까?
하이브리드 노드 같은 건 어떤 모습일까요?그래서 EKS 컨트롤 플레인이 생겼는데, 이 지역에 고장이 났죠.우리는 이제 4~5년 전부터 EKS 제어 비행기를 운영해 왔습니다.우리는 쿠버네티스를 운영해 왔습니다.
AWS에서 9년째 일하고 있습니다.이건 쉬워요.우리가 가지고 있는 건
프로비저닝이 줄었죠.하지만 이제 연결을 시작할 수 있습니다.
온프레미스 노드도 여기에 있습니다.그리고 생각해보면
이전해야 할 새로운 콜로아 시설을 세분화할 수도 있습니다.
하드웨어를 A 레인과 B 레인으로 구분하여 고가용성을 확보할 수 있습니다.
콜로 내부에서는 전류를 사용합니다.
보조 데이터 센터는 DR 페일오버에 불과합니다.따라서 이것이 최선의 선택이라고 생각합니다.컨트롤 플레인 레질리언스
AWS로 오프로드됩니다.많은 옵션 유지 관리
컨트롤 플레인의 부담이 AWS로 오프로드됩니다.기본 데이터 센터를 HA로 사용할 수 있습니다.Chris가 앞서 이야기했듯이 노드 레이블과 테인트 및 톨러레이션에 따라 실제로 사용할 수 있는 것은...그 보조 데이터 센터
바로 사용할 수 있습니다.그냥 몇 개만 바꾸면 돼요
컨트롤 플레인의 파라미터와 모든 것이 다시 스케줄링될 것입니다.우리는 회복이라는 목표를 가지고 있습니다.
모든 것을 확인하는 데 걸리는 시간 목표는 한 시간 미만입니다.
데이터 센터 간 이동.이를 통해 다음과 같은 이점을 얻을 수 있습니다.
과도기적 아키텍처 패턴.온프레미스 애플리케이션도 마찬가지입니다.
계속해서 수익을 창출하고 다음 국가로 전환하려고 노력하고 있습니다.
클라우드를 사용하면 Kubernetes 클라우드 네이티브 방식으로 존재하면서 완전히 삭감될 때까지 온 프레미스 리소스와 AWS 리소스에 동시에 액세스할 수 있습니다.
온프레미스 리소스에서 분리하여 클라우드로 이전할 수 있습니다.그래서 크리스한테 보낸 것 같아요.
아마 한 달에 한 번, 두 달에 한 번 이메일을 보내요.아직 준비 안 됐나요?아직 준비 됐나요?이거 언제 받을 수 있어요?언제 손에 넣을 수 있나요?그리고 약 4개월 전
그러다가 마침내 그가 말했죠. “음, 우리한테 뭔가 있어요.
한 번 해볼까요.”그래서 요구 사항에 따라, 우리가 사용한 것은 바로 이것입니다.
우리의 구현을 위해.그래서 우리는 이미 AWS Direct Connect를 몇 년 동안 실행해 왔고, 이는 훌륭하게 작동하고 있습니다. 우리의 모든 VPC가 어느 정도 도움이 되고 있습니다.
그리고 우리의 온 프레미스 데이터 센터는 마치 같은 네트워크에 있는 것처럼 보입니다.현재 사용 사례에서는 가상 시스템을 사용하고 VMware를 사용합니다.시작하기가 가장 쉬웠습니다.우린 이미 다 가지고 있어요
자동화는 알아냈지만 저희는 정말 베어 메탈에 대해 알아보는 데 관심이 있습니다.
미래의 서버.우리는 데이터센터의 표준 OS로 Red Hat 엔터프라이즈 리눅스를 사용합니다.그리고 우리가 실제로 그랬던 것은 아니었기 때문입니다.
어디에서든 IAM 역할을 사용해보면, 그들의 추천에 따라
처음에는 SSM으로 시작했는데, 그곳에서는 SSM이 가장 좋은 옵션이었습니다.그래서 처음 몇 가지 과정에서 알게 된 몇 가지 교훈을 말씀드리고자 합니다.
며칠 또는 몇 주.크리스가 말한대로, 가져오세요
네트워킹 팀과 보안 팀
이 여정과 함께했습니다.우리는 그의 팀, 크리스의 팀, EKS 팀으로부터 모든 요구 사항을 받았습니다.모든 경로, 모든 방화벽 규칙을 설정해 보았습니다.
올바른 CIDR이 모두 설정되었지만 여전히 문제가 발생했습니다.이러한 조정은 여전히 필요하지만, 여전히 시도해 볼 필요가 있습니다.
이것들을 알아내세요.그리고 그것들을 바로 곁에 두면 이 모든 과정이 완성됩니다.
훨씬 더 순조롭게 진행하세요.제가 하고 싶은 다른 건
클러스터의 구성 요소와 애플리케이션이 통신하는 방식을 제대로 이해하는 것이 좋습니다.데이터 흐름을 이해하세요.현재 문서에는 있지만 처음 시작할 당시에는 없었던 몇 가지 문제에 부딪혔습니다. 예를 들어, 다음과 같은 문제가 발생했습니다.
CNI는 두 가지 모두에 맞게 구성되어 있습니다. 우리는 Cilium을 사용하지만 반드시
두 네트워크 모두에 맞게 구성되어 있습니다.DR 사이트 페일오버를 위해 세 번째 데이터 센터도 마련했습니다.CoreDNS와 같은 중요한 구성 요소가 이들 사이에 분산되어 있는지 확인하세요.Chris가 이에 대해 언급했습니다.우리도 몇 마리를 만났어요
웹훅과 해당 포드 CIDR 범위를 라우팅할 수 있는 문제가 있어서 웹훅을 방금 옮겼습니다.
더 쉽게 하기 위해 AWS로 옮겼습니다.다른 것도 몇 가지 있었습니다.따라서 모든 노드 간 통신에 대한 보안 요구 사항이 있습니다.
전송 중에는 네트워크 내에서 암호화해야 합니다.이제 이 문제는 Nitro 플랫폼 덕분에 AWS 기반 EC2에서 해결되었습니다.
하지만 이 문제를 해결해야 해서 기능을 사용했습니다.
Cilium의 IPsec이라고 불리는데 다른 걸 사용할 수도 있겠죠
암호화를 설정하기 위해 WireGuard도 마찬가지였죠.
노드 간에 말이죠.우리는 또한 많은 것을 만났습니다.
서비스 계정의 IAM 역할을 얻으려고 할 때 발생하는 문제, IRSA
하이브리드 노드에 배포된 워크로드에서 작동하기 위해서입니다.그러고 보니 해야 할 일이 있습니다.
EKS API 서버의 엔드포인트, 즉 퍼블릭 엔드포인트와 프라이빗 엔드포인트를 둘 다 켜놓지 마세요.그래서 Chris 팀과 함께 작업하면서 그 실수를 금방 깨달았습니다.
비공개로만 전환했어요.그럼 새 디자인을 테스트해 보죠.그래서 우리가 겪었던 가장 큰 문제 중 하나는 데이터 센터를 하나도 잃을 수 없었기 때문에 데이터 센터를 확실히 하고 싶었기 때문입니다.
RTO는 괜찮을 것 같았어요.그럼 네트워크를 차단하고 노드를 종료하고 기본 노드로 가정해 봅시다.
데이터센터가 사라졌어요.그런 다음 컨트롤 플레인으로 가서 몇 가지 허용 범위를 변경하거나 제한을 해제하거나 DR 사이트 노드를 스케줄링할 수 있게 만들었습니다.모든 것이 여러분처럼 움직였습니다.
쿠버네티스에서는 예상할 수 있는 일이죠.로드 밸런서를 누르고, 검증하고,
모든 것이 여전히 작동합니다.20분 정도로 줄였는데 많이 할 수 있을 것 같아요
미리 캐싱된 이미지와 좀 더 자동화하면 더 빨라졌죠.앞으로도 계속 작업해 나갈 예정입니다.
이제 GA가 되었으니이제 이걸 정말 깨뜨릴 수 있는지 봅시다.그럼 잘라낼 수 있는지 봅시다.
EKS 컨트롤 플레인을 끄세요.인터넷이 있을지도 몰라요
문제, 네트워킹 문제.AWS 지역은 한 번도 그런 적이 없습니다.
문제죠, 그렇죠, 크리스?그리고 이건 완벽하게 작동했어요.워크로드가 완전히 작동하는 한 전혀 중단되지 않았습니다.
온프레미스에 포함되어 있습니다.다운타임이 전혀 없었어요.이제 기억하세요. 왜냐하면
넌 통제할 수 없어...큐블렛은 말을 못해요
컨트롤 플레인 얘기가 나오면, 이제 정체 상태가 됐어.변화가 없을 거고, 규모를 조정할 수도 없고,
그런 건 안 할 거예요하지만 이러지 않길 바라요
아주 오래 지속되죠.그냥 재미로 놔뒀어요
이 길로 닷새 동안월요일에 시작했는데
금요일에 되돌렸어요모든 것이 동기화되고 백업되었습니다
모든 것이 계속 작동했어요.또한 포드가 실행되는 위치만 변경하면 어떻게 되는지에 대한 사용 사례도 테스트해 보고 싶었습니다.알다시피, 그것도 있잖아요.
이걸 현대화를 위한 플랫폼으로 사용하고 싶다는 생각이 들었어요.
우리의 애플리케이션.이는 순조롭게 작동했습니다.알다시피, 들어가서 노드 셀렉터를 바꿔보세요.
배포할 때 말이죠.에 따라 움직일거에요
포드 파괴 및 롤아웃 전략이 무엇이든 상관없습니다.하지만 여기에는 많은 주의 사항이 있습니다.그건 정말 당신에게 달렸어요.
DNS와 인그레스의 방법, 그리고 몇 가지 용도가 뭔지 아세요?
앱이 제대로 이해되었습니다.그 중에는 어떤 것들이 있나요?
백엔드 종속성이 필요하신가요?하지만 아주 단순한 워크로드의 경우
완벽하게 작동했습니다.제 수석 건축가인 러스 (Russ) 는
제 플랫폼은 커스터마이징이 훨씬 적다는 게 정말 멋졌어요.
이걸 구성하려면 필요했어요.우리는 ECA를 프로비저닝하고 있습니다.
말씀드렸듯이 클러스터는 수년 동안 이어져 왔지만, 이는 정말 단순한 문제였습니다.
프로비저닝 프로세스에 파라미터 몇 개 더 추가하기
다양한 CIDR 범위에 대한 다음 노드 시작 시 약간의 구성을 적용합니다.따라서 현재의 프로비저닝 프로세스에 적용하기가 정말 쉬웠습니다.Anthony는 저의 리드 플랫폼입니다.
엔지니어, 통합과 활용이 매우 쉽다는 것을 알게 되었습니다.
온프레미스 워크로드, 하이브리드 워크로드용 온프레미스 컴퓨팅을 통해 SSM 및 IAM과 같은 기능을 사용할 수 있습니다.다시 말씀드리지만, 그것도 그 중 하나입니다.
앱 현대화 여정을 위해 우리가 정말 기대하는 것들이죠.그래서 앞서 말씀드렸던 6가지 S로 돌아가 보겠습니다.여기서 얻을 수 있는 이점은 무엇일까요?그래서 우리의 안정성과 회복력을 높여줍니다.
온프레미스 플랫폼.일관성을 유지하는 데 도움이 됩니다.
지난 9년간 사용해온 보안 구성 및 플랫폼 가드레일
당사의 클라우드 기반 플랫폼.또한 공통 도구 세트와 공통 개발자가 사용할 수 있습니다.
경험이 있으면 이를 단순화하는 데 도움이 됩니다.더 이상 기억하실 필요가 없습니다. 아, 제가 이걸 여기 배포하고 있는 건가요?이 도구를 사용해야 하는데, 아니면
이 파이프라인은 이렇게 생겼습니다.다른 모니터링 도구 세트일 수도 있습니다.이제 다 똑같아질 거예요애플리케이션을 현대화하고 중복 플랫폼을 제거함으로써 단순화에 도움이 됩니다.
복잡성을 제거합니다.또한 지출을 통제하는 데도 도움이 됩니다. 왜냐하면 지출을 통제할 수 있기 때문입니다.
사용량 기반 플랫폼인 지금은 노드를 사용할 때 사용한 노드에 대해서만 비용을 지불하면 됩니다.반드시 비용을 지불할 필요는 없습니다.
다른 제품에 대한 라이선스 또는 이와 유사한 제품
한 해 동안 최대 사용량이 얼마든지 간에 작업을 수행해야 할 수도 있습니다.또한 이를 통해 사용 중인 데이터를 최대한 활용할 수 있습니다.
온프레미스 컴퓨팅 투자는 도구나 컨트롤 플레인 실행이 아닌 워크로드 실행을 위한 것입니다.그리고 제가 가장 중요하게 생각하는 것은 더 많은 직원과 더 많은 엔지니어가 작업 경험을 쌓을 수 있게 해준다는 것입니다.
좀 더 클라우드 네이티브 방식으로 말이죠.따라서 Amazon EKS 하이브리드 노드는 데이터를 지원할 것입니다.
다가오는 한 해 동안 진행될 예정입니다.그리고 우리는 완전히 성공하기를 희망합니다.
3분기까지 생산에 돌입할 예정입니다.모든 분들께 감사드립니다.
제 이야기를 들어주세요.크리스?(관중들의 박수) - 좋아요, 그럼 여기서 마무리하겠습니다.모두가 세션을 즐겼기를 바랍니다.이번 주에는 수많은 EKS 세션이 있습니다.이 슬라이드에는 몇 가지 관련 내용이 나와 있습니다.관심이 있다면 확인해 보세요.그리고 계속할 수도 있습니다.
온라인 상태의 일부 자산을 통해 EKS 및 EKS 하이브리드 노드에 대해 알아보십시오.어제 하이브리드 노드에 대한 많은 내용을 게시했으니 확인해 보는 것이 좋습니다.
문서 및 기타 자료를 확인해 보세요.
저희가 출판한 것들이죠.정말 고마워요.